# download this sales data

https://github.com/shashank-mishra219/Hive-Class/blob/main/sales_order_data.csv

create table sales_data
(
ORDERNUMBER int,
QUANTITYORDERED int,
PRICEEACH float,
ORDERLINENUMBER int,
SALES float,
STATUS string,
QTR_ID int,
MONTH_ID int,
YEAR_ID int,
PRODUCTLINE string,
MSRP int,
PRODUCTCODE string,
PHONE string,
CITY string,
STATE string,
POSTALCODE string,
COUNTRY string,
TERRITORY string,
CONTACTLASTNAME string,
CONTACTFIRSTNAME string,
DEALSIZE string
)
row format delimited
fields terminated by ','
tblproperties("skip.header.line.count"="1") # this property is for to skip the 1st row while loaing data when we have headers in files
; 

# load data in this table using load command
  load data local inpath 'file:///tmp/hive_class/sales_order_data.csv' into table sales_data;

# same table is cretae for orc format
create table sales_data_orc
(
ORDERNUMBER int,
QUANTITYORDERED int,
PRICEEACH float,
ORDERLINENUMBER int,
SALES float,
STATUS string,
QTR_ID int,
MONTH_ID int,
YEAR_ID int,
PRODUCTLINE string,
MSRP int,
PRODUCTCODE string,
PHONE string,
CITY string,
STATE string,
POSTALCODE string,
COUNTRY string,
TERRITORY string,
CONTACTLASTNAME string,
CONTACTFIRSTNAME string,
DEALSIZE string
)
stored as orc;

# copy data from sales_data into sales_data_orc table using below command

   insert overwrite table sales_data_orc select * from sales_data;

# querying data 
select year_id,sum(sales) as total_sales from sales_data_orc group by year_id;

where we firs above query we got only 1 ampper and one reduer

# In order to change the average load for a reducer (in bytes):                                                                                 
  set hive.exec.reducers.bytes.per.reducer=<number>                                                                                           
# In order to limit the maximum number of reducers:                                                                                             
  set hive.exec.reducers.max=<number>                                                                                                         
# In order to set a constant number of reducers:                                                                                                
  set mapreduce.job.reduces=<number> 
  
# change number of reducers to 3
 set mapreduce.job.reduces=3;

# created table using below command
  create table slaes_year_orc stored as orc as select year_id,sum(sales) as total_sales from sales_data_orc group by year_id;

# When go in the hive warehouse directory and see the number of files for this table is 3 becasue we have set reducers is equal to 3
# if we set 2 then the files will be 2

# when we use below command 
select year_id from sales_data_orc order by year_id desc
 we have set number of reducer 3 still it using 1 and order by globally agrregate data

select year_id from sales_data_orc sort by year_id desc

in this number of reduer is 2 but it showing output of every reducer not gloabal 

